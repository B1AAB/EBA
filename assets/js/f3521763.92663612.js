"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9586],{6944:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"bitcoin/etl/s5b-restore","title":"Restore database dump","description":"Step 5b. Load a database dump","source":"@site/docs/bitcoin/etl/s5b-restore.md","sourceDirName":"bitcoin/etl","slug":"/bitcoin/etl/restore","permalink":"/docs/bitcoin/etl/restore","draft":false,"unlisted":false,"editUrl":"https://github.com/B1AAB/EBA/edit/main/website/docs/bitcoin/etl/s5b-restore.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Restore database dump","description":"Step 5b. Load a database dump","sidebar_position":5,"slug":"/bitcoin/etl/restore"},"sidebar":"tutorialSidebar","previous":{"title":"Import into neo4j","permalink":"/docs/bitcoin/etl/import"},"next":{"title":"Overview","permalink":"/docs/bitcoin/sampling/overview"}}');var a=s(4848),i=s(8453);const r={title:"Restore database dump",description:"Step 5b. Load a database dump",sidebar_position:5,slug:"/bitcoin/etl/restore"},o=void 0,d={},l=[{value:"Prerequisites &amp; setup",id:"prerequisites--setup",level:3},{value:"Download &amp; extract archive",id:"download--extract-archive",level:3},{value:"Restore database dump",id:"restore-database-dump",level:3}];function c(e){const n={a:"a",admonition:"admonition",annotation:"annotation",code:"code",h3:"h3",li:"li",math:"math",mi:"mi",mrow:"mrow",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["On this page, we walk through the steps to populate an empty Neo4j database using our\n",(0,a.jsx)(n.a,{href:"/releases/tags/data-releases",children:"database dump"}),".\nThis approach allows you to skip the resource-intensive\n",(0,a.jsx)(n.a,{href:"./import",children:"bulk import"})," process\nand start querying the full graph significantly faster."]}),"\n",(0,a.jsx)(n.p,{children:"The process involves:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Downloading a multi-part archive of the database dump."}),"\n",(0,a.jsx)(n.li,{children:"Extracting the archive to a local directory."}),"\n",(0,a.jsx)(n.li,{children:"Loading the dump into your Neo4j instance."}),"\n"]}),"\n",(0,a.jsxs)(n.admonition,{title:"Do I need to host a graph database?",type:"tip",children:[(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Yes,"})," if you want to\n",(0,a.jsx)(n.a,{href:"/docs/bitcoin/sampling/overview",children:"sample application-specific communities"})," or\nexplore the graph interactively\n(e.g., querying ",(0,a.jsxs)(n.span,{className:"katex",children:[(0,a.jsx)(n.span,{className:"katex-mathml",children:(0,a.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(n.semantics,{children:[(0,a.jsx)(n.mrow,{children:(0,a.jsx)(n.mi,{children:"n"})}),(0,a.jsx)(n.annotation,{encoding:"application/x-tex",children:"n"})]})})}),(0,a.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(n.span,{className:"base",children:[(0,a.jsx)(n.span,{className:"strut",style:{height:"0.4306em"}}),(0,a.jsx)(n.span,{className:"mord mathnormal",children:"n"})]})})]}),"-hop neighborhoods)."]}),(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"No,"})," if you want\na quick start for developing models using our\n",(0,a.jsx)(n.a,{href:"https://www.kaggle.com/datasets/aab/bitcoin-graph-sampled-communities",children:"generic, pre-sampled communities"}),".\nIn this case, you can jump straight to the\n",(0,a.jsx)(n.a,{href:"https://github.com/B1AAB/GraphStudio/blob/main/g101/g101.ipynb",children:"g101 Jupyter Notebook"})," or\n",(0,a.jsx)(n.a,{href:"https://github.com/B1AAB/GraphStudio/tree/main/quickstart",children:"these quick-start examples"}),"."]})]}),"\n",(0,a.jsxs)(n.admonition,{title:"Resource Requirements",type:"danger",children:[(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Bandwidth:"}),"\nThis process involves downloading nearly ",(0,a.jsx)(n.code,{children:"1 TB"})," of data;\nensure you are using a stable connection without data caps."]}),(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Storage:"})," Ensure you have at least ",(0,a.jsx)(n.code,{children:"4.3 TB"})," of free disk space\n(compressed download: ",(0,a.jsx)(n.code,{children:"~800 GB"}),",\nextracted database dump: ",(0,a.jsx)(n.code,{children:"~800 GB"}),", and\npopulated Neo4j database: ",(0,a.jsx)(n.code,{children:"~2.7 TB"}),")."]})]}),"\n",(0,a.jsx)(n.h3,{id:"prerequisites--setup",children:"Prerequisites & setup"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Install ",(0,a.jsx)(n.a,{href:"/docs/gs/graphdb#neo4j",children:"neo4j graph database"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Install data source CLI: ",(0,a.jsx)(n.a,{href:"https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html",children:"install the AWS CLI"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Install ",(0,a.jsx)(n.a,{href:"https://www.7-zip.org",children:"7-Zip"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo apt update && sudo apt install p7zip-full -y\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"download--extract-archive",children:"Download & extract archive"}),"\n",(0,a.jsxs)(n.p,{children:["The database dump is compressed and split into many chunks\n(",(0,a.jsx)(n.code,{children:"1070"})," chunks, ",(0,a.jsx)(n.code,{children:"700 MB"})," each in ",(0,a.jsx)(n.a,{href:"/releases/data-release/v1",children:"data release v1"}),")\nto ensure reliable downloading."]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Configure environment variables to specify the target directories for downloading and extracting the data."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Set the download path for the multi-part archive. \n# Requires ~800 GB free space.\nexport G_DOWNLOAD_PATH="/mnt/download/path"\n\n# Set the extraction path for the archive.\n# Requires ~800 GB free space.\nexport G_EXTRACT_PATH="/mnt/extract/path"\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Download the database dump files."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'aws s3 sync s3://bitcoin-graph/v1/neo4j_db_dump/ "${G_DOWNLOAD_PATH}" --no-sign-request\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Extract the downloaded multi-part archive."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'7z x "${G_DOWNLOAD_PATH}/neo4j.dump.gz.001" -o"${G_EXTRACT_PATH}"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["By targeting the ",(0,a.jsx)(n.code,{children:".001"})," file, 7-Zip will automatically detect and process the remaining parts in the sequence."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Note that"})," decompressing ",(0,a.jsx)(n.code,{children:"~700 GB"})," of data is a heavy operation, and it will take several hours depending on your disk speed."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"restore-database-dump",children:"Restore database dump"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Stop the database service."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"sudo systemctl stop neo4j\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Restore the database."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'sudo -u neo4j neo4j-admin database load neo4j \\\n    --from-path="${G_EXTRACT_PATH}" \\\n    --overwrite-destination \\\n    --verbose\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Please refer to ",(0,a.jsx)(n.a,{href:"https://neo4j.com/docs/operations-manual/current/backup-restore/restore-dump/",children:"this page"}),"\nfor documentation on the ",(0,a.jsx)(n.code,{children:"database load"})," command."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Note:"})," This step will take a significant amount of time (e.g., 24h) and requires at least ",(0,a.jsx)(n.code,{children:"2.72 TB"})," of free space in the Neo4j database path."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Start the database service."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"sudo systemctl start neo4j\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Enable ",(0,a.jsx)(n.a,{href:"https://neo4j.com/docs/apoc/current/installation/",children:"APOC"}),"."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>o});var t=s(6540);const a={},i=t.createContext(a);function r(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);