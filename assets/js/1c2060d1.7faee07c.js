"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3078],{936:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"bitcoin/etl/s3-address-stats","title":"Address Statistics","description":"Step 3. Update stats","source":"@site/docs/bitcoin/etl/s3-address-stats.md","sourceDirName":"bitcoin/etl","slug":"/bitcoin/etl/address-stats","permalink":"/docs/bitcoin/etl/address-stats","draft":false,"unlisted":false,"editUrl":"https://github.com/B1AAB/EBA/edit/main/website/docs/bitcoin/etl/s3-address-stats.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Address Statistics","description":"Step 3. Update stats","sidebar_position":2,"slug":"/bitcoin/etl/address-stats"},"sidebar":"tutorialSidebar","previous":{"title":"Extract Block Data","permalink":"/docs/bitcoin/etl/traverse"},"next":{"title":"TXO Lifecycle","permalink":"/docs/bitcoin/etl/txo-lifecycle"}}');var i=t(4848),r=t(8453);const a={title:"Address Statistics",description:"Step 3. Update stats",sidebar_position:2,slug:"/bitcoin/etl/address-stats"},o=void 0,d={},c=[];function l(e){const s={admonition:"admonition",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.admonition,{type:"info",children:[(0,i.jsxs)(s.p,{children:["This is an optional step,\nand it details a process that requires address tracking to have been enabled during ",(0,i.jsx)(s.code,{children:"eba bitcoin traverse"}),"."]}),(0,i.jsx)(s.p,{children:"You may skip this step if you do not intent to get per-block statistics."})]}),"\n",(0,i.jsx)(s.p,{children:"The goal is to calculate various block-level address statistics,\nsuch as identifying new vs. previously seen addresses,\nand counting unique and total addresses per block."}),"\n",(0,i.jsx)(s.p,{children:"Generating these statistics requires efficient uniqueness checking\nacross vast amounts of data.\nWhile in-memory checks are effective for small data,\nthey don't scale to a large list of Bitcoin addresses.\nWe also found that using a database (e.g., PostgreSQL)\nto track address uniqueness during the traversal process\nintroduced significant overhead."}),"\n",(0,i.jsx)(s.p,{children:"Therefore, we utilize a two-step post-processing approach:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Step 1: Address Logging During Traversal:\nDuring the ",(0,i.jsx)(s.code,{children:"traverse"})," command, all addresses are simply\nappended to plain text files.\nNo costly indexing or uniqueness checks are performed at this stage."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Step 2: Disk-based Post-Traversal Uniqueness Check:\nFirst, the large addresses text file from step 1 are sorted using a disk-based sorting method.\nThen, a custom tool processes the sorted list and the calculation of all necessary statistics."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"The specific steps are outlined below ."}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Merge all the files (you may skip this if you have only one file):"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-shell",children:"cat *_addresses.tsv > combined_addresses.tsv\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Sorted the merged file:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-shell",children:"LC_ALL=C sort --buffer-size=32G --parallel=16 --temporary-directory=. -t$'\\t' -k1,1 combined_addresses.tsv -o sorted_combined_addresses.tsv\n\nreal    1166m35.442s\nuser    62m13.415s\nsys     33m40.558s\n"})}),"\n",(0,i.jsx)(s.p,{children:"This uses 32G RAM and uses disk for temporarily storing files needed for sorting large files.\nYou may adjust the RAM size and make sure enough storage space on the specified paths."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Run the ",(0,i.jsx)(s.code,{children:"EXP_AddAddressStatsToBlockStats"})," project. (Experimental)"]}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>a,x:()=>o});var n=t(6540);const i={},r=n.createContext(i);function a(e){const s=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);